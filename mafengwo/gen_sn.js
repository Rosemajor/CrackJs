

var r = ["0", "1", "2", "3", "4", "5", "6", "7", "8", "9", "a", "b", "c", "d", "e", "f"];
function u(t, e) {
    var n = t[0];
    var r = t[1];
    var i = t[2];
    var o = t[3];
    n += (r & i | ~r & o) + e[0] - 680876936 | 0,
        o += ((n = (n << 7 | n >>> 25) + r | 0) & r | ~n & i) + e[1] - 389564586 | 0,
        i += ((o = (o << 12 | o >>> 20) + n | 0) & n | ~o & r) + e[2] + 606105819 | 0,
        r += ((i = (i << 17 | i >>> 15) + o | 0) & o | ~i & n) + e[3] - 1044525330 | 0,
        n += ((r = (r << 22 | r >>> 10) + i | 0) & i | ~r & o) + e[4] - 176418897 | 0,
        o += ((n = (n << 7 | n >>> 25) + r | 0) & r | ~n & i) + e[5] + 1200080426 | 0,
        i += ((o = (o << 12 | o >>> 20) + n | 0) & n | ~o & r) + e[6] - 1473231341 | 0,
        r += ((i = (i << 17 | i >>> 15) + o | 0) & o | ~i & n) + e[7] - 45705983 | 0,
        n += ((r = (r << 22 | r >>> 10) + i | 0) & i | ~r & o) + e[8] + 1770035416 | 0,
        o += ((n = (n << 7 | n >>> 25) + r | 0) & r | ~n & i) + e[9] - 1958414417 | 0,
        i += ((o = (o << 12 | o >>> 20) + n | 0) & n | ~o & r) + e[10] - 42063 | 0,
        r += ((i = (i << 17 | i >>> 15) + o | 0) & o | ~i & n) + e[11] - 1990404162 | 0,
        n += ((r = (r << 22 | r >>> 10) + i | 0) & i | ~r & o) + e[12] + 1804603682 | 0,
        o += ((n = (n << 7 | n >>> 25) + r | 0) & r | ~n & i) + e[13] - 40341101 | 0,
        i += ((o = (o << 12 | o >>> 20) + n | 0) & n | ~o & r) + e[14] - 1502002290 | 0,
        r += ((i = (i << 17 | i >>> 15) + o | 0) & o | ~i & n) + e[15] + 1236535329 | 0,
        n += ((r = (r << 22 | r >>> 10) + i | 0) & o | i & ~o) + e[1] - 165796510 | 0,
        o += ((n = (n << 5 | n >>> 27) + r | 0) & i | r & ~i) + e[6] - 1069501632 | 0,
        i += ((o = (o << 9 | o >>> 23) + n | 0) & r | n & ~r) + e[11] + 643717713 | 0,
        r += ((i = (i << 14 | i >>> 18) + o | 0) & n | o & ~n) + e[0] - 373897302 | 0,
        n += ((r = (r << 20 | r >>> 12) + i | 0) & o | i & ~o) + e[5] - 701558691 | 0,
        o += ((n = (n << 5 | n >>> 27) + r | 0) & i | r & ~i) + e[10] + 38016083 | 0,
        i += ((o = (o << 9 | o >>> 23) + n | 0) & r | n & ~r) + e[15] - 660478335 | 0,
        r += ((i = (i << 14 | i >>> 18) + o | 0) & n | o & ~n) + e[4] - 405537848 | 0,
        n += ((r = (r << 20 | r >>> 12) + i | 0) & o | i & ~o) + e[9] + 568446438 | 0,
        o += ((n = (n << 5 | n >>> 27) + r | 0) & i | r & ~i) + e[14] - 1019803690 | 0,
        i += ((o = (o << 9 | o >>> 23) + n | 0) & r | n & ~r) + e[3] - 187363961 | 0,
        r += ((i = (i << 14 | i >>> 18) + o | 0) & n | o & ~n) + e[8] + 1163531501 | 0,
        n += ((r = (r << 20 | r >>> 12) + i | 0) & o | i & ~o) + e[13] - 1444681467 | 0,
        o += ((n = (n << 5 | n >>> 27) + r | 0) & i | r & ~i) + e[2] - 51403784 | 0,
        i += ((o = (o << 9 | o >>> 23) + n | 0) & r | n & ~r) + e[7] + 1735328473 | 0,
        r += ((i = (i << 14 | i >>> 18) + o | 0) & n | o & ~n) + e[12] - 1926607734 | 0,
        n += ((r = (r << 20 | r >>> 12) + i | 0) ^ i ^ o) + e[5] - 378558 | 0,
        o += ((n = (n << 4 | n >>> 28) + r | 0) ^ r ^ i) + e[8] - 2022574463 | 0,
        i += ((o = (o << 11 | o >>> 21) + n | 0) ^ n ^ r) + e[11] + 1839030562 | 0,
        r += ((i = (i << 16 | i >>> 16) + o | 0) ^ o ^ n) + e[14] - 35309556 | 0,
        n += ((r = (r << 23 | r >>> 9) + i | 0) ^ i ^ o) + e[1] - 1530992060 | 0,
        o += ((n = (n << 4 | n >>> 28) + r | 0) ^ r ^ i) + e[4] + 1272893353 | 0,
        i += ((o = (o << 11 | o >>> 21) + n | 0) ^ n ^ r) + e[7] - 155497632 | 0,
        r += ((i = (i << 16 | i >>> 16) + o | 0) ^ o ^ n) + e[10] - 1094730640 | 0,
        n += ((r = (r << 23 | r >>> 9) + i | 0) ^ i ^ o) + e[13] + 681279174 | 0,
        o += ((n = (n << 4 | n >>> 28) + r | 0) ^ r ^ i) + e[0] - 358537222 | 0,
        i += ((o = (o << 11 | o >>> 21) + n | 0) ^ n ^ r) + e[3] - 722521979 | 0,
        r += ((i = (i << 16 | i >>> 16) + o | 0) ^ o ^ n) + e[6] + 76029189 | 0,
        n += ((r = (r << 23 | r >>> 9) + i | 0) ^ i ^ o) + e[9] - 640364487 | 0,
        o += ((n = (n << 4 | n >>> 28) + r | 0) ^ r ^ i) + e[12] - 421815835 | 0,
        i += ((o = (o << 11 | o >>> 21) + n | 0) ^ n ^ r) + e[15] + 530742520 | 0,
        r += ((i = (i << 16 | i >>> 16) + o | 0) ^ o ^ n) + e[2] - 995338651 | 0,
        n += (i ^ ((r = (r << 23 | r >>> 9) + i | 0) | ~o)) + e[0] - 198630844 | 0,
        o += (r ^ ((n = (n << 6 | n >>> 26) + r | 0) | ~i)) + e[7] + 1126891415 | 0,
        i += (n ^ ((o = (o << 10 | o >>> 22) + n | 0) | ~r)) + e[14] - 1416354905 | 0,
        r += (o ^ ((i = (i << 15 | i >>> 17) + o | 0) | ~n)) + e[5] - 57434055 | 0,
        n += (i ^ ((r = (r << 21 | r >>> 11) + i | 0) | ~o)) + e[12] + 1700485571 | 0,
        o += (r ^ ((n = (n << 6 | n >>> 26) + r | 0) | ~i)) + e[3] - 1894986606 | 0,
        i += (n ^ ((o = (o << 10 | o >>> 22) + n | 0) | ~r)) + e[10] - 1051523 | 0,
        r += (o ^ ((i = (i << 15 | i >>> 17) + o | 0) | ~n)) + e[1] - 2054922799 | 0,
        n += (i ^ ((r = (r << 21 | r >>> 11) + i | 0) | ~o)) + e[8] + 1873313359 | 0,
        o += (r ^ ((n = (n << 6 | n >>> 26) + r | 0) | ~i)) + e[15] - 30611744 | 0,
        i += (n ^ ((o = (o << 10 | o >>> 22) + n | 0) | ~r)) + e[6] - 1560198380 | 0,
        r += (o ^ ((i = (i << 15 | i >>> 17) + o | 0) | ~n)) + e[13] + 1309151649 | 0,
        n += (i ^ ((r = (r << 21 | r >>> 11) + i | 0) | ~o)) + e[4] - 145523070 | 0,
        o += (r ^ ((n = (n << 6 | n >>> 26) + r | 0) | ~i)) + e[11] - 1120210379 | 0,
        i += (n ^ ((o = (o << 10 | o >>> 22) + n | 0) | ~r)) + e[2] + 718787259 | 0,
        r = ((r += (o ^ ((i = (i << 15 | i >>> 17) + o | 0) | ~n)) + e[9] - 343485551 | 0) << 21 | r >>> 11) + i | 0,
        t[0] = n + t[0] | 0,
        t[1] = r + t[1] | 0,
        t[2] = i + t[2] | 0,
        t[3] = o + t[3] | 0
}

function l(t) {
    var e, n = [];
    for (e = 0; e < 64; e += 4)
        n[e >> 2] = t.charCodeAt(e) + (t.charCodeAt(e + 1) << 8) + (t.charCodeAt(e + 2) << 16) + (t.charCodeAt(e + 3) << 24);
    return n
}
function f(t) {
    var e, n = [];
    for (e = 0; e < 64; e += 4)
        n[e >> 2] = t[e] + (t[e + 1] << 8) + (t[e + 2] << 16) + (t[e + 3] << 24);
    return n
}


function i(t) {
    var e, n, r, i, o, a, s = t.length, c = [1732584193, -271733879, -1732584194, 271733878];
    for (e = 64; e <= s; e += 64)
        u(c, l(t.substring(e - 64, e)));
    for (t = t.substring(e - 64),
             n = t.length,
             r = [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
             e = 0; e < n; e += 1)
        r[e >> 2] |= t.charCodeAt(e) << (e % 4 << 3);
    if (r[e >> 2] |= 128 << (e % 4 << 3),
    55 < e)
        for (u(c, r),
                 e = 0; e < 16; e += 1)
            r[e] = 0;
    return i = (i = 8 * s).toString(16).match(/(.*?)(.{0,8})$/),
        o = parseInt(i[2], 16),
        a = parseInt(i[1], 16) || 0,
        r[14] = o,
        r[15] = a,
        u(c, r),
        c
}


function n(t) {
    var e, n = "";
    for (e = 0; e < 4; e += 1)
        n += r[t >> 8 * e + 4 & 15] + r[t >> 8 * e & 15];
    return n
}
function a(t) {
    var e;
    for (e = 0; e < t.length; e += 1)
        t[e] = n(t[e]);
    return t.join("")
}


function main(input_t) {
    var _fe = "c9d6618dbc657b41a66eb0af952906f1"
    var _res = i(input_t + _fe)
    return a(_res).slice(2, 12)
}


var my_fe = "c9d6618dbc657b41a66eb0af952906f1"
var demo_t = "{\"_ts\":\"1624783247383\",\"adults_num\":\"2\",\"check_in\":\"2021-06-27\",\"check_out\":\"2021-06-28\",\"children_age\":\"\",\"hotel_id\":\"97816\",\"mdd_id\":\"10198\",\"ota_ids\":\"\",\"queryTimes\":\"1\",\"screen_scale\":\"3.0000001192092896\"}"
demo_t += my_fe


var res = i(demo_t)
console.log(res)

var driver_res = [1675628723, -743870660, 392444254, -1361707127]
console.log(driver_res)
console.log(res.toString() === driver_res.toString())
console.log(res.toString())
console.log(driver_res.toString())


var demo_sn = a(res)
my_t = "b310e0633c6fa9d35e39641789ffd5ae"
console.log(my_t === demo_sn)

var my_sn = "10e0633c6f"
console.log(demo_sn.slice(2, 12))
console.log(my_sn === demo_sn.slice(2, 12))


//  "{\"_ts\":\"1624768699499\",\"adults_num\":\"2\",\"check_in\":\"2021-06-28\",\"check_out\":\"2021-06-29\",\"children_age\":\"\",\"hotel_id\":\"8316708\",\"mdd_id\":\"10198\",\"ota_ids\":\"\",\"queryTimes\":\"1\",\"screen_scale\":\"2.75\"}"

demo_t = "{\"_ts\":\"1624768699499\",\"adults_num\":\"2\",\"check_in\":\"2021-06-28\",\"check_out\":\"2021-06-29\",\"children_age\":\"\",\"hotel_id\":\"8316708\",\"mdd_id\":\"10198\",\"ota_ids\":\"\",\"queryTimes\":\"1\",\"screen_scale\":\"2.75\"}"

my_sn = "d18417a473"
demo_sn = main(demo_t)
console.log(demo_sn)
console.log(my_sn === demo_sn)


/**

 总结：

 1、_sn 字段就是请求参数的相关加密

     加密过程是：将请求的参数转换为 json 字符串，而且注意顺序，_ts 字段一定是在前面的，

     即：
     demo_t = "{\"_ts\":\"1624768699499\",\"adults_num\":\"2\",\"check_in\":\"2021-06-28\",\"check_out\":\"2021-06-29\",\"children_age\":\"\",\"hotel_id\":\"8316708\",\"mdd_id\":\"10198\",\"ota_ids\":\"\",\"queryTimes\":\"1\",\"screen_scale\":\"2.75\"}"

 2、然后直接调用  main()  来加密即可

 */
